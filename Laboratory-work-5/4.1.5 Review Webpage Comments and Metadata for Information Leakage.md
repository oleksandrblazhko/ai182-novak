# Перегляньте вміст веб-сторінки на наявність витоку інформації

### ID WSTG-INFO-05

## Резюме
Програмістам дуже часто і навіть рекомендовано включати детальні коментарі та метадані у вихідний код. Однак коментарі та метадані, включені до HTML-коду, можуть виявити внутрішню інформацію, яка не повинна бути доступна потенційним зловмисникам. Необхідно перевірити коментарі та метадані, щоб визначити, чи не стався витік інформації.
 
Для сучасних веб-додатків використання JavaScript на стороні клієнта для інтерфейсу стає все більш популярним. Популярні технології створення інтерфейсу використовують клієнтський JavaScript, як-от ReactJS, AngularJS або Vue. Подібно до коментарів і метаданих у HTML-коді, багато програмістів також жорстко вписують конфіденційну інформацію у змінні JavaScript на інтерфейсі. Конфіденційна інформація може включати (але не обмежується цим): приватні ключі API ( наприклад , необмежений ключ API Google Map), внутрішні IP-адреси, конфіденційні маршрути ( наприклад , маршрут до прихованих сторінок адміністратора або функції) або навіть облікові дані. Ця конфіденційна інформація може витікати з такого зовнішнього коду JavaScript. Необхідно провести перевірку, щоб визначити, чи стався витік конфіденційної інформації, яка може бути використана зловмисниками для зловживання.
 
Для великих веб-додатків проблеми з продуктивністю викликають серйозне занепокоєння програмістів. Програмісти використовували різні методи для оптимізації продуктивності інтерфейсу, зокрема Syntactically Awesome Style Sheets (SASS), Sassy CSS (SCSS), webpack тощо. Використовуючи ці технології, інтерфейсний код інколи стає важчим для розуміння та налагодження, і через це програмісти часто розгортають вихідні файли карти для цілей налагодження. «Вихідна карта» — це спеціальний файл, який з’єднує мінімізовану/змінену версію ресурсу (CSS або JavaScript) із оригінальною авторською версією. Програмісти все ще обговорюють, чи варто переносити вихідні файли карт у робоче середовище. Однак незаперечним є той факт, що вихідні файли карт або файли для налагодження, якщо їх випустять у робоче середовище, зроблять їх джерело більш зручним для читання. Це може полегшити зловмисникам пошук уразливостей у інтерфейсі або збирати з нього конфіденційну інформацію. Потрібно перевірити код JavaScript, щоб визначити, чи є якісь файли налагодження відкритими з інтерфейсу. Залежно від контексту та чутливості проекту експерт із безпеки має вирішити, чи повинні файли існувати у робочому середовищі чи ні.

## Цілі тесту
*	Перегляньте коментарі та метадані веб-сторінки, щоб знайти витік інформації.
*	Зберіть файли JavaScript і перегляньте код JS, щоб краще зрозуміти додаток і знайти витік інформації.
*	Визначте, чи існують вихідні файли карти або інші файли налагодження зовнішнього середовища.

## Як тестувати
### Перегляньте коментарі та метадані веб-сторінки
Коментарі HTML часто використовуються розробниками для включення інформації про налагодження програми. Іноді вони забувають про коментарі та залишають їх у робочих середовищах. Тестери повинні шукати коментарі HTML, які починаються з <!--.

Перевірте вихідний код HTML на наявність коментарів, що містять конфіденційну інформацію, яка може допомогти зловмиснику отримати більше інформації про програму. Це може бути код SQL, імена користувачів і паролі, внутрішні IP-адреси або інформація про налагодження.

		...
		<div class="table2">
		  <div class="col1">1</div><div class="col2">Mary</div>
		  <div class="col1">2</div><div class="col2">Peter</div>
		  <div class="col1">3</div><div class="col2">Joe</div>
		
		<!-- Query: SELECT id, name FROM app.users WHERE active='1' 		-->
		
		</div>
		...

Тестер може навіть знайти щось подібне до цього:

		<!-- Use the DB administrator password for testing:  f@keP@a$$w0rD -->

Перевірте інформацію про версію HTML на дійсні номери версій і URL-адреси визначення типу даних (DTD).

		<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
		"http://www.w3.org/TR/html4/strict.dtd">
*	strict.dtd– строгий DTD за замовчуванням
*	loose.dtd– вільний DTD
*	frameset.dtd– DTD для документів фреймів

Деякі METAтеги не надають активних векторів атаки, а натомість дозволяють зловмиснику профілювати програму:

		<META name="Author" content="Andrew Muller">

Поширеним (але не сумісним з WCAG ) METAтегом є Refresh .

		<META http-equiv="Refresh" content="15;
		URL=https://www.owasp.org/index.html">

Зазвичай METAтег використовується для визначення ключових слів, які пошукова система може використовувати для покращення якості результатів пошуку.

		<META name="keywords" lang="en-us" content="OWASP,
		security, sunshine, lollipops">

Хоча більшість веб-серверів керують індексацією пошукової системи через robots.txtфайл, ним також можна керувати за допомогою METAтегів. Тег нижче рекомендує роботам не індексувати та не переходити за посиланнями на сторінці HTML, що містить тег.

		<META name="robots" content="none">

Платформа вибору вмісту в Інтернеті (PICS) і протокол для ресурсів веб-опису (POWDER) забезпечують інфраструктуру для зв’язування метаданих із вмістом Інтернету.

### Ідентифікація коду JavaScript і збір файлів JavaScript

Програмісти часто жорстко кодують конфіденційну інформацію за допомогою змінних JavaScript на інтерфейсі. Тестери повинні перевірити вихідний код HTML і знайти код JavaScript між тегами <script>і . </script>Тестери також повинні ідентифікувати зовнішні файли JavaScript, щоб перевірити код (файли JavaScript мають розширення файлу .jsта ім’я файлу JavaScript, яке зазвичай додається в srcатрибут (джерело) тегу <script>).

Перевірте код JavaScript на наявність будь-яких витоків конфіденційної інформації, які можуть бути використані зловмисниками для подальшого зловживання або маніпулювання системою. Шукайте такі значення, як ключі API, внутрішні IP-адреси, конфіденційні маршрути або облікові дані. Наприклад:

		const myS3Credentials = {
		  accessKeyId: config('AWSS3AccessKeyID'),
		  secretAcccessKey: config('AWSS3SecretAccessKey'),
		};

Тестер може навіть знайти щось подібне до цього:

		var conString = "tcp://postgres:1234@localhost/postgres";

Коли ключ API знайдено, тестувальники можуть перевірити, чи встановлено обмеження ключа API для кожної служби чи IP-адреси, реферера HTTP, програми, SDK тощо.

Наприклад, якщо тестувальники знайшли ключ API Карт Google, вони можуть перевірити, чи цей ключ API обмежено IP-адресою чи лише API Карт Google. Якщо ключ API Google обмежено лише для API Карт Google, зловмисники все одно можуть використовувати цей ключ API для запитів до необмежених API Карт Google, і власник програми повинен заплатити за це.

		
		<script type="application/json">
		...
		{"GOOGLE_MAP_API_KEY":"AIzaSyDUEBnKgwiqMNpDplT6ozE4Z0XxuAbqDi4", "RECAPTCHA_KEY":"6LcPscEUiAAAAHOwwM3fGvIx9rsPYUq62uRhGjJ0"}
		...
		</script>

У деяких випадках тестувальники можуть знайти конфіденційні маршрути з коду JavaScript, наприклад посилання на внутрішні або приховані сторінки адміністратора.

		<script type="application/json">
		...
		"runtimeConfig":{"BASE_URL_VOUCHER_API":"https://staging-voucher.victim.net/api", 		
		"BASE_BACKOFFICE_API":"https://10.10.10.2/api","ADMIN_PAGE":"/hidden_administrator"}
		...
		</script>

### Ідентифікація вихідних файлів карти
Файли вихідної карти зазвичай завантажуються, коли відкриваються DevTools. Тестувальники також можуть знайти вихідні файли карт, додавши розширення «.map» після розширення кожного зовнішнього файлу JavaScript. Наприклад, якщо тестувальник бачить /static/js/main.chunk.jsфайл, він може перевірити вихідний файл карти, відвідавши /static/js/main.chunk.js.map.

Тестування чорної скриньки

Перевірте вихідні файли карти на наявність будь-якої конфіденційної інформації, яка може допомогти зловмиснику отримати більше інформації про програму. Наприклад:
{
  "version": 3,
  "file": "static/js/main.chunk.js",
  "sources": [
    "/home/sysadmin/cashsystem/src/actions/index.js",
    "/home/sysadmin/cashsystem/src/actions/reportAction.js",
    "/home/sysadmin/cashsystem/src/actions/cashoutAction.js",
    "/home/sysadmin/cashsystem/src/actions/userAction.js",
    "..."
  ],
  "..."
}
Коли веб-сайти завантажують вихідні файли карти, зовнішній вихідний код стає читабельним і легшим для налагодження.

## Інструменти
*	Wget
*	Функція «перегляд джерела» браузера
*	Очні яблука
*	Локон
*	Burp Suite
*	Waybackurls
*	Сканер Google Maps API

## Список літератури
*	KeyHacks

## Офіційні документи
*	HTML версії 4.01
*	XHTML
*	HTML версія 5


