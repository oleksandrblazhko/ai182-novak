
# V5.4 Память, рядки та некерований код
Наступні вимоги будуть актуальними, якщо програма використовує мову асемблера або некерований код.


| № | Опис | L1 | L2 | L3 | CWE |
| ------------ | ------------ | ------------ | ------------ | ------------ | ------------ |
| 5.4.1 | Переконайтеся, що для виявлення або запобігання ситуацій переповнення стека, буфера або купи додаток враховує розмір доступної області пам'яті при рядкових операціях, копіюванні в пам'ять, арифметиці покажчиків і т.п. | | + | + | 120 |
| 5.4.2 |Переконайтеся, що рядок форматування не містить потенційно шкідливих вхідних даних і є незмінним. | | +|+ |134 |
| 5.4.3 | Переконайтеся, що для запобігання цілісному переповненню застосовується контроль знака, діапазону та типу допустимих вхідних даних | | +|+ | 190 |

## CWE-120: Буферна копія без перевірки розміру введення ("Класичний переповнення буфера")

### Опис: __________
Програма копіює вхідний буфер в буфер виведення, не перевіряючи, що розмір вхідного буфера менше розміру вихідного буфера, що призводить до переповнення буфера.
### Розширений опис
Умова переповнення буфера існує, коли програма намагається помістити в буфер більше даних, ніж вона може утримувати, або коли програма намагається помістити дані в область пам'яті за межами буфера. Найпростішим типом помилки, і найпоширенішою причиною переповнення буфера, є «класичний» випадок, при якому програма копіює буфер, не обмежуючи, скільки копіюється. Існують і інші варіанти, але існування класичного переливу настійно говорить про те, що програміст не розглядає навіть саму базову з охоронних захистів.
### Застосовні платформи
#### Мови
C (невизначена поширеність)
C++ (невизначена поширеність)
Клас: Збірка (невизначена поширеність)
### Загальні наслідки
| Масштаб  | Вплив  | Ймовірність  |
| ------------ | ------------ | ------------ |
| Доступність конфіденційності цілісності  |_Технічний вплив: модифікувати пам'ять; Виконання несанкціонованого коду або команд._ Переповнення буфера часто може використовуватися для виконання довільного коду, який зазвичай виходить за рамки неявної політики безпеки програми. Це часто можна використовувати для підриву будь-якої іншої служби безпеки. |   |
| Наявність  |  _Технічний вплив: модифікувати пам'ять; DoS: збій, вихід або перезапуск; DoS: Споживання ресурсів (ЦП)_ Переповнення буфера, як правило, призводить до збоїв. Можливі й інші атаки, що призводять до відсутності доступності, включаючи введення програми в нескінченний цикл. |   |

### Імовірність прояву
Високий

## CWE-134: використання рядка формату із зовнішнім контролем

### Опис: __________
Програмне забезпечення використовує функцію, яка приймає рядок форматування як аргумент, але рядок формату походить із зовнішнього джерела.
### Розширений опис
Коли зловмисник може змінити рядок формату, контрольований ззовні, це може призвести до переповнення буфера, відмови в обслуговуванні або проблем із представленням даних.
Слід зазначити, що в деяких обставинах, таких як інтернаціоналізація, набір форматних рядків зовні контролюється дизайном. Якщо джерело цих рядків формату є надійним (наприклад, міститься лише у файлах бібліотеки, які можна змінити лише системним адміністратором), зовнішній елемент керування може сам по собі не створювати вразливості.

### Застосовні платформи
#### Мови
C (часто поширений)
C++ (часто поширений)
Perl (рідко поширений)

### Загальні наслідки
| Масштаб  |  Вплив |  Ймовірність |
| ------------ | ------------ | ------------ |
| Конфіденційність  | _Технічний вплив: читання пам'яті_ Проблеми з рядком формату дозволяють розкривати інформацію, що може значно спростити експлуатацію програми.  |   |
|   Доступність конфіденційності цілісності| _Технічний вплив: модифікувати пам'ять; Виконання несанкціонованого коду або команд_ Проблеми з форматуванням рядків можуть призвести до виконання довільного коду.  |   |

### Імовірність прояву
Високий

## CWE-190: цілочисельний перелив або обгортання
### Опис: __________
Програма виконує обчислення, яке може призвести до цілочисельного переповнення або обтікання, коли логіка передбачає, що отримане значення завжди буде більше вихідного значення. Це може призвести до інших слабких сторін, коли розрахунок використовується для управління ресурсами або контролю виконання.
### Розширений опис
Переповнення цілого числа або обтікання відбувається, коли ціле значення збільшується до значення, яке є занадто великим для зберігання в пов'язаному поданні. Коли це відбувається, значення може обернутися, щоб стати дуже маленьким або від'ємним числом. Хоча це може бути передбачуваною поведінкою в обставинах, які покладаються на обгортання, це може мати наслідки для безпеки, якщо обгортка несподівана. Особливо це стосується тих випадків, коли цілочисельне переповнення може бути спрацьовувати за допомогою вхідних даних, що поставляються користувачем. Це стає критично важливим для безпеки, коли результат використовується для контролю циклу, прийняття рішення щодо безпеки або визначення зміщення або розміру в поведінці, такій як розподіл пам'яті, копіювання, об'єднання тощо.

### Застосовні платформи
#### Мови

Клас: Не специфічна для мови (невизначена поширеність)

### Загальні наслідки
|  Масштаб | Вплив  |  Ймовірність |
| ------------ | ------------ | ------------ |
|Наявність| _Технічний вплив: DoS: збій, вихід або перезапуск; DoS: споживання ресурсів (CPU); DoS: споживання ресурсів (пам'ять); DoS: нестабільність_ Ця слабкість, як правило, призведе до невизначеної поведінки і, отже, аварій. У разі переповнення за участю змінних індексу циклу ймовірність нескінченних циклів також висока.  |   |
|Цілісність  |_Технічний вплив: модифікація пам'яті_  Якщо значення, про яке йде мова, важливо для даних (на відміну від потоку), сталося просте пошкодження даних. Крім того, якщо обгортання призводить до інших умов, таких як переповнення буфера, може статися подальше пошкодження памяті.   |   |
|Контроль доступу до доступності конфіденційності  |_Технічний вплив: виконання несанкціонованого коду або команд; Механізм захисту байпаса_ Ця слабкість іноді може викликати переповнення буфера, яке можна використовувати для виконання довільного коду. Зазвичай це виходить за рамки неявної політики безпеки програми.   |   |




### Імовірність прояву
Середнє





